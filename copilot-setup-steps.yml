# GitHub Copilot Setup Steps for NLWebNet
# This file defines the setup steps needed to work with the NLWebNet repository

name: Setup .NET 9 Environment for NLWebNet
description: Install .NET 9 SDK and restore dependencies for the NLWebNet library and demo application

steps:
  - name: Install .NET 9 SDK
    description: Install the .NET 9 SDK using the official Microsoft installation methods
    run: |
      # Check if .NET 9 is already installed
      if command -v dotnet &> /dev/null && dotnet --list-sdks | grep -q "9\."; then
        echo "‚úÖ .NET 9 SDK is already installed"
        dotnet --version
        exit 0
      fi
      
      # Install .NET 9 SDK using official Microsoft methods
      echo "üì¶ Installing .NET 9 SDK..."
      
      # For Ubuntu/Debian
      if command -v apt &> /dev/null; then
        # Add Microsoft package repository
        wget https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
        sudo dpkg -i packages-microsoft-prod.deb
        rm packages-microsoft-prod.deb
        
        # Install .NET 9 SDK
        sudo apt update
        sudo apt install -y dotnet-sdk-9.0
      
      # For macOS with Homebrew
      elif command -v brew &> /dev/null; then
        brew install dotnet
      
      # For other systems, use the official install script (same as GitHub Actions uses internally)
      else
        echo "Using official Microsoft .NET install script..."
        curl -sSL https://dot.net/v1/dotnet-install.sh | bash /dev/stdin --channel 9.0 --install-dir ~/.dotnet
        
        # Add .NET to PATH if not already present
        if [[ ":$PATH:" != *":$HOME/.dotnet:"* ]]; then
          echo 'export PATH="$HOME/.dotnet:$PATH"' >> ~/.bashrc
          export PATH="$HOME/.dotnet:$PATH"
        fi
      fi
      
      # Verify installation
      echo "üîç Verifying .NET installation..."
      dotnet --version
      dotnet --info

  - name: Restore NuGet packages
    description: Restore all NuGet package dependencies for the solution
    run: |
      dotnet restore

  - name: Build solution
    description: Build the entire solution to verify setup is working
    run: |
      dotnet build --configuration Debug --no-restore

  - name: Verify setup
    description: Run a quick verification that everything is set up correctly
    run: |
      echo "‚úÖ .NET 9 SDK installed successfully"
      echo "‚úÖ NuGet packages restored"
      echo "‚úÖ Solution builds successfully"
      echo ""
      echo "üöÄ You can now work with the NLWebNet repository!"
      echo ""
      echo "Quick start commands:"
      echo "  - Build: dotnet build"
      echo "  - Test: dotnet test"
      echo "  - Run demo: dotnet run --project demo"